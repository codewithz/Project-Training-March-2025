(()=>{var isNumber=function(value){return"number"==typeof value},withDefault=function(val,def){return null==val?def:val};function resetCache(){cardTimesCache=boardCache=cachedBoard=statusCache=void 0}var statusCache,loadingStatus,boardCache,loadingBoard,assign=function(target){if(Object.assign)return Object.assign.apply(null,arguments);if(null==target)throw new TypeError("Cannot convert first argument to object");for(var to=Object(target),i=1;i<arguments.length;i++){var nextSource=arguments[i];if(null!=nextSource)for(var keysArray=Object.keys(Object(nextSource)),nextIndex=0,len=keysArray.length;nextIndex<len;nextIndex++){var nextKey=keysArray[nextIndex],desc=Object.getOwnPropertyDescriptor(nextSource,nextKey);void 0!==desc&&desc.enumerable&&(to[nextKey]=nextSource[nextKey])}}return to},includes=function(array,elem){return array&&0<=array.indexOf(elem)},findIndex=function(array,predicate,thisArg){if(Array.prototype.findIndex)return Array.prototype.findIndex.call(array,predicate);for(var len=array.length>>>0,k=0;k<len;){var kValue=array[k];if(predicate.call(thisArg,kValue,k,array))return k;k++}return-1},SECOND=1e3,MINUTE=6e4,HOUR=36e5,DAY=864e5,TIME_FROM_LARGEST=[2628e6,6048e5,DAY,HOUR,MINUTE,SECOND],NAMES_FROM_LARGEST=["month","week","day","hour","minute","second"],formatTime=function(ms){var smallerIdx,unit;return ms<SECOND?"1 second":(smallerIdx=findIndex(TIME_FROM_LARGEST,function(t){return t<ms}),unit=TIME_FROM_LARGEST[smallerIdx],smallerIdx=NAMES_FROM_LARGEST[smallerIdx],unit=Math.round(ms/unit),"".concat(unit," ").concat(smallerIdx).concat(1===unit?"":"s"))},encodeParams=function(params){return Object.keys(params).reduce(function(acc,k){var val=params[k];return val&&(k=encodeURIComponent(k)+"="+encodeURIComponent(val),acc.push(k)),acc},[]).join("&")},Promise$1=TrelloPowerUp.Promise,CORRELLO_URL="https://app.getcorrello.com",sendRequest=function(method,url,params){return new Promise$1(function(resolve,reject){var encodedParams=params&&encodeParams(params),req=("GET"===method&&encodedParams&&(url=url+"?"+encodedParams),new XMLHttpRequest);req.open(method,url,!0),req.setRequestHeader("Content-type","application/x-www-form-urlencoded"),req.addEventListener("load",function(){var statusCode=parseInt(req.status);resolve({text:req.responseText,status:statusCode,ok:200<=statusCode&&statusCode<300})}),req.addEventListener("error",function(e){return reject(e.error)}),"GET"===method?req.send():req.send(encodedParams)})},getStatus=function(){return loadingStatus||(void 0===statusCache||0<arguments.length&&void 0!==arguments[0]&&arguments[0]?loadingStatus=sendRequest("GET",CORRELLO_URL+"/Plugin/status").then(function(resp){return JSON.parse(resp.text)}).then(function(s){return statusCache=s}).finally(function(){return loadingStatus=null}).catch(function(e){return console.error("Failed to get status",e),{}}):Promise$1.resolve(statusCache))},getBoardData=function(boardId,reportDefId){return loadingBoard||(void 0===boardCache||2<arguments.length&&void 0!==arguments[2]&&arguments[2]?loadingBoard=sendRequest("GET",CORRELLO_URL+"/Plugin/board/"+boardId,{reportDefId:reportDefId}).then(function(resp){return resp.ok?JSON.parse(resp.text):{boardManaged:!1}}).then(function(s){return boardCache=s}).catch(function(){return{boardManaged:!1}}).finally(function(){return loadingBoard=null}):Promise$1.resolve(boardCache))},cachedBoard=null,cachedReport=null,cardTimesCache=null,loadingCardTimes=null,getCardTimes=function(boardId,reportDefId){return loadingCardTimes||(cachedBoard==boardId&&cachedReport==reportDefId&&cardTimesCache?Promise$1.resolve(cardTimesCache):loadingCardTimes=sendRequest("GET",CORRELLO_URL+"/Plugin/board/"+boardId+"/cardAddedToList",{reportDefId:reportDefId}).then(function(r){return 200<=r.status&&r.status<300?JSON.parse(r.text):getStatus(boardId,!0)}).then(function(cardTimes){return cachedBoard=boardId,cachedReport=reportDefId,cardTimesCache=cardTimes}).finally(function(){return loadingCardTimes=null}))},getCardTimeFromCache=function(cardId,boardId,reportDefId){return getCardTimes(boardId,reportDefId).then(function(times){return times[cardId]})},getCardTimeFromServer=function(cardId,boardId,reportDefId){return sendRequest("GET",CORRELLO_URL+"/Plugin/card/"+cardId+"/addedToList",{reportDefId:reportDefId}).then(function(resp){if(200<=resp.status&&resp.status<300)return JSON.parse(resp.text);if(404!==resp.status)throw new Error("Corrello request failed: "+resp.status)})},getCardTimeInList=function(cardId,listId,boardId,reportDefId){return getCardTimeFromCache(cardId,boardId,reportDefId).then(function(cardTime){return cardTime?cardTime.listId===listId?cardTime:void delete cardTimesCache[cardId]:getCardTimeFromServer(cardId,boardId,reportDefId).then(function(cardTime){if(cardTime&&cardTime.listId===listId)return cardTimesCache[cardId]=cardTime})}).then(function(cardTime){return cardTime&&!cardTime.addedToListMs?null:cardTime?(new Date).getTime()-cardTime.addedToListMs:void 0})},POINTS_ICON="./images/icon-points.svg",POINTS_ICON_WHITE="./images/icon-points-white.svg",TIME_IN_LIST_ICON="./images/days-in-list.svg",TIME_IN_LIST_ICON_WHITE="./images/days-in-list-white.svg",WIP_OVER_LIMITS_WHITE="./images/wip-over-limits-white.svg",WIP_OVER_LIMITS="./images/wip-over-limits.svg";function unwrapExports(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function createCommonjsModule(fn,module){return fn(module={exports:{}},module.exports),module.exports}var arrayLikeToArray=createCommonjsModule(function(module){module.exports=function(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n},module.exports.__esModule=!0,module.exports.default=module.exports}),arrayWithoutHoles=(unwrapExports(arrayLikeToArray),createCommonjsModule(function(module){module.exports=function(r){if(Array.isArray(r))return arrayLikeToArray(r)},module.exports.__esModule=!0,module.exports.default=module.exports})),iterableToArray=(unwrapExports(arrayWithoutHoles),createCommonjsModule(function(module){module.exports=function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)},module.exports.__esModule=!0,module.exports.default=module.exports})),unsupportedIterableToArray=(unwrapExports(iterableToArray),createCommonjsModule(function(module){module.exports=function(r,a){var t;if(r)return"string"==typeof r?arrayLikeToArray(r,a):"Map"===(t="Object"===(t={}.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?arrayLikeToArray(r,a):void 0},module.exports.__esModule=!0,module.exports.default=module.exports})),nonIterableSpread=(unwrapExports(unsupportedIterableToArray),createCommonjsModule(function(module){module.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},module.exports.__esModule=!0,module.exports.default=module.exports})),toConsumableArray=(unwrapExports(nonIterableSpread),createCommonjsModule(function(module){module.exports=function(r){return arrayWithoutHoles(r)||iterableToArray(r)||unsupportedIterableToArray(r)||nonIterableSpread()},module.exports.__esModule=!0,module.exports.default=module.exports})),_toConsumableArray=unwrapExports(toConsumableArray),_asyncToGenerator=unwrapExports(createCommonjsModule(function(module){function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value}catch(n){return e(n)}i.done?t(u):Promise.resolve(u).then(r,o)}module.exports=function(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n)}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n)}_next(void 0)})}},module.exports.__esModule=!0,module.exports.default=module.exports})),_typeof_1=createCommonjsModule(function(module){function _typeof(o){return module.exports=_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},module.exports.__esModule=!0,module.exports.default=module.exports,_typeof(o)}module.exports=_typeof,module.exports.__esModule=!0,module.exports.default=module.exports}),toConsumableArray=(unwrapExports(_typeof_1),createCommonjsModule(function(module){var _typeof=_typeof_1.default;function _regeneratorRuntime(){module.exports=function(){return e},module.exports.__esModule=!0,module.exports.default=module.exports;var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function(t,e,r){return t[e]=r}}function wrap(t,e,r,n){e=e&&e.prototype instanceof Generator?e:Generator,e=Object.create(e.prototype),n=new Context(n||[]);return o(e,"_invoke",{value:makeInvokeMethod(t,r,n)}),e}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var i={},d=(define(i,a,function(){return this}),Object.getPrototypeOf),d=d&&d(d(values([]))),g=(d&&d!==r&&n.call(d,a)&&(i=d),GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(i));function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var u,r=tryCatch(t[r],t,o);if("throw"!==r.type)return(o=(u=r.arg).value)&&"object"==_typeof(o)&&n.call(o,"__await")?e.resolve(o.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(o).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)});a(r.arg)}var r;o(this,"_invoke",{value:function(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){c=function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=tryCatch(o,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(c,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;c=tryCatch(e,r,n);if("normal"===c.type){if(o=n.done?s:l,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=s,n.method="throw",n.arg=c.arg)}}}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var o,r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return o=-1,(r=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next}).next=r}throw new TypeError(_typeof(e)+" is not iterable")}return o(g,"constructor",{value:GeneratorFunction.prototype=GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var n,e=Object(t),r=[];for(n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;0<=o;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}var a=(i=i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc?null:i)?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,o,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(o=n.arg,resetTryEntry(r)),o}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}module.exports=_regeneratorRuntime,module.exports.__esModule=!0,module.exports.default=module.exports}));unwrapExports(toConsumableArray);var regenerator=toConsumableArray=toConsumableArray();try{regeneratorRuntime=toConsumableArray}catch(accidentalStrictMode){"object"==typeof globalThis?globalThis.regeneratorRuntime=toConsumableArray:Function("r","regeneratorRuntime = r")(toConsumableArray)}function asyncGetBadgesData(t){var boardId=t.getContext().board,card=t.card("id","idList","attachments"),points=t.get("card","shared","points"),markUnestimated=t.get("board","private","markUnestimated",!1),allowedPoints=asyncGetPointsAllowed(t),account=getStatus(),t=t.get("board","shared").then(function(s){return getBoardData(boardId,s.defaultReport).then(function(b){return assign({},b,s)})});return Promise$2.props({account:account,board:t,card:card,points:points,markUnestimated:markUnestimated,allowedPoints:allowedPoints})}function getBadges(t,data){var account=data.account,board=data.board,card=data.card,points=data.points,markUnestimated=data.markUnestimated,data=data.allowedPoints,badges=[],colorCode=withDefault(board.colorCodePoints,!0);return board.useCards||(isNumber(points)?badges.push(getPointsBadge(points,data,colorCode)):markUnestimated&&!hasHelloEpicChildAttachment(card.attachments)&&badges.push(MARK_UNESTIMATED_BADGE)),shouldShowTimeInList(account,board,card)&&(points=getTimeInListBadge(t,board,card),badges.push(points)),badges}function showOnboarding(t){t.modal({url:"./onboarding.html",title:"Welcome to Agile Tools by Corrello",height:520,accentColor:"#1A73E8"})}function setPointsOnCard(t){t.popup({title:"Set Story Points",url:"./popup-set-points.html",height:157})}function showAgileTools(t){return t.popup({title:"Agile Tools",url:"./board-menu.html",height:200})}function showWhatsNew(t){t.modal({url:"./whats-new.html",title:"What's new in Agile Tools by Corrello",height:444})}var DEFAULT_POINTS=[1,2,3,5,8,13,21],asyncGetPointsAllowed=(()=>{var _ref=_asyncToGenerator(regenerator.mark(function _callee(t){var pointsAllowed;return regenerator.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,t.get("board","shared","pointsAllowed",DEFAULT_POINTS);case 2:return pointsAllowed=_context.sent,_context.abrupt("return",(arr=>{if((arr=>!arr||!arr.length)(arr))return!0;if(arr.filter(function(n){return n&&0<=n}).length<=0)return!0;var a=arr,b=[1,2,2,3,5,8,8,13];if(a!==b){if(null==a||null==b||a.length!=b.length)return!1;for(var i=0;i<a.length;++i)if(a[i]!==b[i])return!!void 0}return!!1})(pointsAllowed)?DEFAULT_POINTS:pointsAllowed);case 4:case"end":return _context.stop()}},_callee)}));return function(_x){return _ref.apply(this,arguments)}})(),Promise$2=TrelloPowerUp.Promise,LIST_LIMIT_RE=/\[\s*(\d+)\s*\]/,COLORS=["lime","green","yellow","orange"],MARK_UNESTIMATED_BADGE={title:"Story points",text:"Unestimated",icon:POINTS_ICON_WHITE,color:"red"},getColor=function(allowedPoints,points){var length;return 0===points?"light-gray":(length=allowedPoints.length,allowedPoints=0===(allowedPoints=findIndex(allowedPoints,function(p){return points<p}))?0:allowedPoints<0?COLORS.length-1:Math.floor((allowedPoints-1)/length*COLORS.length),COLORS[allowedPoints])},getPointsBadge=function(points,allowedPoints,colorCode){allowedPoints=colorCode?getColor(allowedPoints,points):"blue";return{title:"Story points",text:points.toString(10),color:allowedPoints,icon:colorCode&&0===points?POINTS_ICON:POINTS_ICON_WHITE}},getTimeInListBadge=function(t,board,card){var boardId=t.getContext().board,reportId=board.defaultReport,slowCardThreshold=board.slowCardThresholds[card.idList];return{dynamic:function(){return getCardTimeInList(card.id,card.idList,boardId,reportId).then(function(time){var refresh=30,isSlow=!1,text="refreshing";return null===time?(refresh=900,text="unknown"):time&&(refresh=getRefreshTime(time),isSlow=slowCardThreshold&&slowCardThreshold<time/DAY,text=formatTime(time)),{title:"Time in list",text:text,refresh:refresh,icon:isSlow?TIME_IN_LIST_ICON_WHITE:TIME_IN_LIST_ICON,color:isSlow?"red":void 0}})}}},getRefreshTime=function(timeInList){return HOUR<timeInList?900:10*MINUTE<timeInList?120:MINUTE<timeInList?60:10},getWipLimit=function(t,boardSettings,listId){return boardSettings.wipUseListName?t.list("name").then(function(_ref){_ref=_ref.name,_ref=LIST_LIMIT_RE.exec(_ref);return _ref&&parseInt(_ref[1])}):(t=boardSettings.wipLimits&&boardSettings.wipLimits[listId],Promise$2.resolve(t))},getListSize=function(t){return t.list("cards").then(function(_ref2){return _ref2.cards.length})},shouldShowTimeInList=function(account,board,card){account=account&&account.subscriptionActive&&board.boardManaged,card=account&&includes(board.managedLists,card.idList),board=card&&void 0===board.showTimeInList||board.showTimeInList;return account&&card&&board},hasHelloEpicChildAttachment=function(attachments){for(var childIdRegex=/trello.com\/c\/([^\/?]+)/,i=attachments.length-1;0<=i;i--){var url=attachments[i].url,url=childIdRegex.exec(url);if(url)if(24===url[1].length)return!0}return!1};TrelloPowerUp.initialize({"card-badges":function(t){var p_data=asyncGetBadgesData(t),p_badges=p_data.then(function(data){return getBadges(t,data)}),p_data=p_data.then(function(data){var board=data.board;if(board.showWipLimits)return[((board,card)=>({dynamic:function(t){return getWipLimit(t,board,card.idList).then(function(limit){if(limit)return Promise$2.props({limit:limit,size:getListSize(t)})}).then(function(props){var color;return props?(color=props.limit<props.size?"red":props.limit===props.size?"yellow":null,{title:"List size",refresh:10,text:"".concat(props.size,"/").concat(props.limit),color:color,icon:color?WIP_OVER_LIMITS_WHITE:WIP_OVER_LIMITS}):{refresh:10}})}}))(board,data.card)]});return Promise$2.join(p_badges,p_data,function(badges,frontBadges){return frontBadges?[].concat(_toConsumableArray(badges),_toConsumableArray(frontBadges)):badges}).catch(function(e){return console.error("Failed to load front badges",e)})},"card-detail-badges":function(t){return asyncGetBadgesData(t).then(function(data){return getBadges(t,data)})},"card-buttons":function(t,options){return t.get("board","shared").then(function(settings){return"write"!==options.context.permissions.card||settings.useCards?[]:[{icon:POINTS_ICON,text:"Story Points",callback:setPointsOnCard}]})},"board-buttons":function(t){var isSignedIn=t.isMemberSignedIn();return(t=>t.get("board","shared","pointsEnabledOn").then(function(pointsEnabledOn){if(!pointsEnabledOn)return t.set("board","shared","pointsEnabledOn",(new Date).getTime())}))(t),t.get("board","private").then(function(_ref){var firstRunDone=_ref.firstRunDone,buttons=[{icon:"./images/agiletools-logo-white.svg",text:"Agile Tools",callback:showAgileTools}];return isSignedIn&&(firstRunDone?(_ref.whatsNew||0)<2&&buttons.push({icon:"./images/icon-info.svg",text:"What's new in Agile Tools",callback:showWhatsNew}):buttons.push({icon:"./images/icon-info.svg",text:"Get started with Agile Tools",callback:showOnboarding})),buttons})},"show-settings":function(t){return t.popup({title:"Agile Tools Settings",url:"./settings.html",height:220,callback:resetCache})},"on-enable":showOnboarding})})();
//# sourceMappingURL=powerup.js.map
